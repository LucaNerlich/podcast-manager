### Test downloading an episode from a public feed (no token required)
GET {{baseUrl}}/api/episodes/{{episodeId}}/download
Accept: */*

### Test downloading an episode with a token (private feed)
GET {{baseUrl}}/api/episodes/{{episodeId}}/download?token={{userToken}}
Accept: */*

### Test unauthorized access (should return 403)
GET {{baseUrl}}/api/episodes/{{episodeId}}/download?token=invalid-token
Accept: */*

### Example of what will be sent to Umami for analytics
POST {{umamiUrl}}
Content-Type: application/json

{
  "type": "event",
  "payload": {
    "hostname": "podcasthub.org",
    "language": "en-US",
    "referrer": "",
    "screen": "1920x1080",
    "title": "Example Episode Title",
    "url": "/episode/example-episode-title",
    "website": "{{umamiWebsiteId}}",
    "name": "podcast_download",
    "data": {
      "episode_id": "{{episodeId}}",
      "title": "Example Episode Title"
    }
  }
}

### Environment variables for local testing
# @name variables
@baseUrl = http://localhost:1337
@episodeId = your-episode-document-id
@userToken = your-user-token
@umamiUrl = https://analytics.example.com
@umamiWebsiteId = your-website-id 